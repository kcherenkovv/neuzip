# Оптимизация производительности системы автоматического распознавания вооружения в видеопотоке путём нейросетевого сжатия весов с использованием библиотеки NeuZip

## Описание проекта
Данный проект посвящен оптимизации производительности системы автоматического распознавания вооружения в видеопотоке путём нейросетевого сжатия весов с использованием библиотеки [Neuzip](https://github.com/BorealisAI/neuzip). В работе исследуются различные архитектуры нейронных сетей (YOLOv8, YOLOv11) и методы оптимизации для достижения максимальной скорости и точности детекции.

## Схема работы
![Схема работы](https://github.com/kcherenkovv/neuzip/blob/main/images/Диаграмма%20без%20названия.jpg)

Все этапы работы (обучение модели, экспорт в ONNX, оптимизация) детально описаны в **[master_notebook.ipynb](https://github.com/kcherenkovv/neuzip/blob/main/master_notebook.ipynb)**.

## Датасет
Датасет состоит из 5678 изображений, каждое из которых имеет аннотации в формате .txt.  Включает 6 классов объектов: пистолет (pistol), смартфон (smartphone), нож (knife), кошелек (wallet), купюра (bill), карта (card).

Датасет является результатом объединения общедоступных материалов и данных, предоставленных компанией [Арсенал+](https://arsplus.ru/).

Файл конфигурации датасета (пути к изображениям, классам) хранится в файле `dataset.yaml`.

### Баланс классов
* Доля ножей и пистолетов: 65.41% от всех объектов.
* Вспомогательные классы (wallet, bill, card, smartphone): относительно равномерное распределение, smartphone немного доминирует (34.67%).

## Используемые технологии

*   **Язык программирования**: Python 3.10
*   **Фреймворк машинного обучения**: PyTorch 2.1.0
*   **Библиотеки**: NumPy 2.1.2, NeuZip
*   **CUDA**: 12.4
*   **Архитектуры нейронных сетей**: YOLOv8, YOLOv11
*   **Облачный сервер**: [Immers cloud](https://immers.cloud/) (Tesla A100, 16 vCPU, 64 GB RAM, 160 GB Disk, Ubuntu 22.04.4, CUDA 12.3)

## Этапы работы
1.  **Подготовка датасета**: Сбор и разметка данных, создание конфигурационного файла `dataset.yaml`.
2.  **Обучение моделей**: Обучение YOLOv8, YOLOv11 на подготовленном датасете.
3.  **Экспорт в ONNX**: Конвертация обученных моделей в формат ONNX для дальнейшей оптимизации.
4.  **Оптимизация NeuZip**: Применение библиотеки NeuZip для сжатия весов моделей.
5.  **Сравнение моделей**: Сравнение исходных и оптимизированных моделей по метрикам mAP, mAP50-95 и времени инференса.

## Результаты

| Model   | Version   | Inf. ms | Inf. NeuZip ms | mAP50 | Speed Δ |
|---------|-----------|---------|----------------|-------|---------|
| YOLOv8  | Original  | 11.1    | –              | 0.836 | –       |
| YOLOv8  | Optimized | 11.1    | 8.8            | 0.836 | ~20%    |
| YOLOv11 | Original  | 13.8    | –              | 0.834 | –       |
| YOLOv11 | Optimized | 13.8    | 9.9            | 0.834 | ~28%    |







